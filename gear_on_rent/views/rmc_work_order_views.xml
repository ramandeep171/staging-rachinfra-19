<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="view_rmc_monthly_order_tree" model="ir.ui.view">
        <field name="name">gear.rmc.monthly.order.tree</field>
        <field name="model">gear.rmc.monthly.order</field>
        <field name="arch" type="xml">
            <list string="Monthly Work Orders">
                <field name="name"/>
                <field name="so_id"/>
                <field name="workcenter_id"/>
                <field name="x_inventory_mode"/>
                <field name="x_real_warehouse_id"/>
                <field name="date_start"/>
                <field name="date_end"/>
                <field name="x_window_start"/>
                <field name="x_window_end"/>
                <field name="x_is_cooling_period"/>
                <field name="state"/>
                <field name="monthly_target_qty"/>
                <field name="adjusted_target_qty"/>
                <field name="prime_output_qty"/>
                <field name="optimized_standby_qty"/>
                <field name="ngt_hours"/>
                <field name="loto_hours"/>
                <field name="excess_diesel_litre_total"/>
                <field name="excess_diesel_amount_total"/>
                <field name="prime_rate"/>
                <field name="optimize_rate"/>
                <field name="ngt_rate"/>
                <field name="excess_rate"/>
            </list>
        </field>
    </record>

    <record id="view_rmc_monthly_order_form" model="ir.ui.view">
        <field name="name">gear.rmc.monthly.order.form</field>
        <field name="model">gear.rmc.monthly.order</field>
        <field name="arch" type="xml">
            <form string="RMC Monthly Work Order">
                <header>
                    <button name="action_schedule_orders"
                            type="object"
                            string="Generate Daily Orders"
                            class="btn-primary"
                            invisible="state == 'done'"/>
                    <button name="action_mark_done"
                            type="object"
                            string="Mark Done"
                            class="btn-success"
                            invisible="state == 'done'"/>
                    <button name="action_open_prepare_invoice"
                            type="object"
                            string="Prepare Invoice"
                            class="btn-primary"
                            invisible="state == 'draft' or (not has_remaining_invoice_window)"/>
                    <button name="action_print_month_end_report"
                            type="object"
                            string="Download Month-End Report"
                            class="btn-secondary"
                            invisible="invoice_count == 0 or state == 'draft'"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,scheduled,done"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <label for="name" class="oe_form_label"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_invoices"
                                type="object"
                                class="oe_stat_button"
                                invisible="invoice_count == 0">
                            <div class="o_stat_info">
                                <span class="o_stat_value">
                                    <field name="invoice_count" widget="statinfo"/>
                                </span>
                                <span class="o_stat_text">Invoices</span>
                            </div>
                        </button>
                    </div>
                    <field name="has_active_invoice" invisible="1"/>
                    <field name="has_remaining_invoice_window" invisible="1"/>
                    <field name="last_billed_end" invisible="1"/>
                    <group>
                        <group string="Basic Information">
                            <field name="so_id" required="1"/>
                            <field name="product_id" required="1"/>
                            <field name="workcenter_id"/>
                            <field name="company_id" invisible="1"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                        <group string="Dates &amp; Window">
                            <field name="date_start"/>
                            <field name="date_end"/>
                            <field name="x_window_start" readonly="state != 'draft'"/>
                            <field name="x_window_end" readonly="state != 'draft'"/>
                            <field name="x_is_cooling_period"/>
                            <field name="x_auto_email_daily"/>
                            <field name="apply_waveoff_remaining"/>
                        </group>
                    </group>
                    <group>
                        <group string="Inventory Settings">
                            <field name="x_inventory_mode"/>
                            <field name="x_real_warehouse_id"/>
                        </group>
                        <group string="MGQ &amp; Targets">
                            <field name="x_monthly_mgq_snapshot" readonly="1"/>
                            <field name="mgq_monthly" readonly="1"/>
                            <field name="monthly_target_qty" readonly="1"/>
                            <field name="adjusted_target_qty" readonly="1"/>
                            <field name="prime_output_qty" readonly="1"/>
                            <field name="optimized_standby_qty" readonly="1" invisible="x_is_cooling_period"/>
                        </group>
                    </group>
                    <notebook>
                    <page string="Manufacturing Orders">
                            <field name="production_ids">
                                <list editable="bottom">
                                    <field name="name"/>
                                    <button name="action_open_self"
                                            type="object"
                                            icon="fa-external-link"
                                            class="btn-link"
                                            help="Open this manufacturing order"/>
                                    <button name="action_print_daily_report"
                                            type="object"
                                            icon="fa-print"
                                            string="PDF"
                                            class="btn-link"
                                            context="{'download': True}"/>
                                    <field name="date_start"/>
                                    <field name="x_daily_target_qty" sum="Total"/>
                                    <field name="x_adjusted_target_qty" sum="Total"/>
                                    <field name="x_prime_output_qty" sum="Total"/>
                                    <field name="x_optimized_standby_qty" sum="Total" column_invisible="parent.x_is_cooling_period"/>
                                    <field name="x_ngt_hours" sum="Total"/>
                                    <field name="x_loto_hours" sum="Total"/>
                                </list>
                            </field>
                        </page>
                        <page string="Dockets">
                            <field name="docket_ids" readonly="1">
                                <list>
                                    <field name="date"/>
                                    <field name="docket_no"/>
                                    <field name="workcenter_id"/>
                                    <field name="qty_m3"/>
                                    <field name="runtime_minutes"/>
                                    <field name="idle_minutes"/>
                                    <field name="actual_loading_minutes"/>
                                    <field name="excess_minutes"/>
                                    <field name="excess_diesel_amount"/>
                                    <field name="reason_id"/>
                                    <field name="state"/>
                                </list>
                            </field>
                        </page>
                        <page string="Rates &amp; Snapshots">
                            <group>
                                <group>
                                    <field name="prime_rate" readonly="1"/>
                                    <field name="optimize_rate" readonly="1"/>
                                </group>
                                <group>
                                    <field name="ngt_rate" readonly="1"/>
                                    <field name="excess_rate" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Wastage Tracking">
                            <group>
                                <group>
                                    <field name="wastage_allowed_percent" readonly="1"/>
                                    <field name="wastage_penalty_rate" />
                                    <field name="mwo_prime_output_qty" readonly="1"/>
                                    <field name="mwo_allowed_wastage_qty" readonly="1"/>
                                </group>
                                <group>
                                    <field name="mwo_actual_scrap_qty" readonly="1"/>
                                    <field name="mwo_over_wastage_qty" readonly="1"/>
                                    <field name="mwo_deduction_qty" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Relief &amp; Downtime">
                            <group>
                                <group>
                                    <field name="downtime_relief_qty" readonly="1"/>
                                    <field name="downtime_total_hours" readonly="1"/>
                                    <field name="ngt_hours" readonly="1"/>
                                    <field name="loto_hours" readonly="1"/>
                                    <field name="waveoff_hours_applied" readonly="1"/>
                                </group>
                                <group>
                                    <field name="waveoff_hours_chargeable" readonly="1" invisible="loto_hours &lt;= 48.0"/>
                                    <field name="loto_waveoff_hours" readonly="1"/>
                                    <field name="waveoff_hours_remaining" readonly="1"/>
                                    <field name="bank_pull_limit" readonly="1"/>
                                    <field name="ngt_hourly_prorata_factor" readonly="1"/>
                                </group>
                                <group>
                                    <field name="ngt_employee_expense"/>
                                    <field name="ngt_land_rent"/>
                                    <field name="ngt_electricity_unit_rate"/>
                                    <field name="ngt_meter_units" readonly="1"/>
                                    <field name="ngt_electricity_expense" readonly="1"/>
                                    <field name="ngt_total_expense" readonly="1"/>
                                    <field name="ngt_effective_rate" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Prime &amp; Manual">
                            <group>
                                <group>
                                    <field name="prime_output_qty" readonly="1"/>
                                    <field name="manual_on_qty" readonly="1"/>
                                    <field name="manual_after_qty" readonly="1"/>
                                    <field name="prime_with_manual_qty" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Diesel Tracking">
                            <group>
                                <group>
                                    <field name="standard_loading_minutes"/>
                                    <field name="diesel_burn_rate_per_hour"/>
                                    <field name="diesel_rate_per_litre"/>
                                </group>
                                <group>
                                    <field name="excess_diesel_litre_total" readonly="1"/>
                                    <field name="excess_diesel_amount_total" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Runtime">
                            <group>
                                <group>
                                    <field name="runtime_minutes" readonly="1"/>
                                    <field name="idle_minutes" readonly="1"/>
                                </group>
                                <group>
                                    <field name="docket_count" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        <page string="Other">
                            <group>
                                <group>
                                    <field name="cooling_months" readonly="1"/>
                                </group>
                                <group>
                                    <field name="last_generated_date" readonly="1"/>
                                </group>
                            </group>
                        </page>
                        
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="action_rmc_monthly_order" model="ir.actions.act_window">
        <field name="name">Monthly Work Orders</field>
        <field name="res_model">gear.rmc.monthly.order</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p>
                Manage the monthly work orders orchestrating daily manufacturing orders and IDS dockets.
            </p>
        </field>
    </record>

    <record id="view_mrp_production_form_inherit_gear_wastage" model="ir.ui.view">
        <field name="name">mrp.production.form.inherit.gear.wastage</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet/notebook" position="inside">
                <page string="Wastage" name="gear_wastage_page">
                    <group>
                        <field name="wastage_allowed_percent" readonly="1"/>
                        <field name="wastage_penalty_rate" />
                        <field name="prime_output_qty" readonly="1"/>
                        <field name="wastage_allowed_qty" readonly="1"/>
                        <field name="actual_scrap_qty" readonly="1"/>
                        <field name="over_wastage_qty" readonly="1"/>
                        <field name="deduction_qty" readonly="1"/>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>
